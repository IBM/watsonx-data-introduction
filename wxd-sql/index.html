
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>SQL Examples - Introducing watsonx.data</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"IBM Plex Sans";--md-code-font:"IBM Plex Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sql-examples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Introducing watsonx.data" class="md-header__button md-logo" aria-label="Introducing watsonx.data" data-md-component="logo">
      
  <img src="../wxd-images/IBM_logo®_rev_RGB.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introducing watsonx.data
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SQL Examples
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Introducing watsonx.data" class="md-nav__button md-logo" aria-label="Introducing watsonx.data" data-md-component="logo">
      
  <img src="../wxd-images/IBM_logo®_rev_RGB.png" alt="logo">

    </a>
    Introducing watsonx.data
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-ibmid/" class="md-nav__link">
        Requesting an IBMid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-workshop/" class="md-nav__link">
        Accessing a workshop
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-lab-instructions/" class="md-nav__link">
        Lab Instructions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          watsonx.data UI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="watsonx.data UI" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          watsonx.data UI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-watsonui/" class="md-nav__link">
        Watsonx UI Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-infrastructure/" class="md-nav__link">
        Infrastructure Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-datamanager/" class="md-nav__link">
        Data Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-queryworkspace/" class="md-nav__link">
        Query Workspace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-queryhistory/" class="md-nav__link">
        Query History
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-accesscontrol/" class="md-nav__link">
        Access Control
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Presto SQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Presto SQL" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Presto SQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-query/" class="md-nav__link">
        Using the Query Workspace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-prestocli/" class="md-nav__link">
        Presto SQL Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-analytics/" class="md-nav__link">
        Analytic Workloads
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-advanced/" class="md-nav__link">
        Advanced Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-timetravel/" class="md-nav__link">
        Time Travel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-federation/" class="md-nav__link">
        Federation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Optional Features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Optional Features" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Optional Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-jupyter/" class="md-nav__link">
        Jupyter Notebook
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-presto/" class="md-nav__link">
        Presto UI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../wxd-documentation/" class="md-nav__link">
        Documentation
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          SQL Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        SQL Examples
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-7-access-control" class="md-nav__link">
    Chapter 7 - Access Control
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-8-query-workspace" class="md-nav__link">
    Chapter 8 - Query Workspace
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-9-prestodb-sql" class="md-nav__link">
    Chapter 9 - PrestoDB SQL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-10-analytic-workloads" class="md-nav__link">
    Chapter 10 - Analytic Workloads
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-advanced-functions" class="md-nav__link">
    11 - Advanced Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-time-travel" class="md-nav__link">
    12 - Time Travel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-federation" class="md-nav__link">
    13 Federation
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../wxd-glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../wxd-disclaimer/" class="md-nav__link">
        Disclaimer
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-7-access-control" class="md-nav__link">
    Chapter 7 - Access Control
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-8-query-workspace" class="md-nav__link">
    Chapter 8 - Query Workspace
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-9-prestodb-sql" class="md-nav__link">
    Chapter 9 - PrestoDB SQL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-10-analytic-workloads" class="md-nav__link">
    Chapter 10 - Analytic Workloads
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-advanced-functions" class="md-nav__link">
    11 - Advanced Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-time-travel" class="md-nav__link">
    12 - Time Travel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-federation" class="md-nav__link">
    13 Federation
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="sql-examples">SQL Examples</h1>
<p>This section contains all of the SQL examples used throughout the lab. You can copy the SQL from this chapter to use in the Query Workspace, rather than having to cut and paste them from documentation or type them in.</p>
<p>Each SQL statement will reference the chapter in the PDF documentation.</p>
<h2 id="chapter-7-access-control">Chapter 7 - Access Control</h2>
<div class="admonition abstract">
<p class="admonition-title">7.1 Enter this text into the SQL window and Run the code</p>
<div class="highlight"><pre><span></span><code>SELECT
  *
FROM
  &quot;hive_data&quot;.&quot;ontime&quot;.&quot;ontime&quot;
LIMIT
  10;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">7.2 Enter this text into the SQL window and Run the code</p>
<div class="highlight"><pre><span></span><code>SELECT
  flightdate, reporting_airline, flight_number_reporting_airline, originairportid, destairportid
FROM
  &quot;hive_data&quot;.&quot;ontime&quot;.&quot;ontime&quot;
LIMIT
  10;
</code></pre></div>
</div>
<h2 id="chapter-8-query-workspace">Chapter 8 - Query Workspace</h2>
<div class="admonition abstract">
<p class="admonition-title">8.1 Retrieve 10 rows from the ontime table</p>
<div class="highlight"><pre><span></span><code>SELECT
  *
FROM
  &quot;hive_data&quot;.&quot;ontime&quot;.&quot;ontime&quot;
LIMIT
  10;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">8.2 Copy the following SQL and place it into the SQL window</p>
<div class="highlight"><pre><span></span><code>SELECT * FROM &quot;hive_data&quot;.&quot;ontime&quot;.&quot;ontime&quot; LIMIT 10;
SELECT * FROM &quot;hive_data&quot;.&quot;ontime&quot;.&quot;ontime&quot; LIMIT 20;
</code></pre></div>
</div>
<h2 id="chapter-9-prestodb-sql">Chapter 9 - PrestoDB SQL</h2>
<div class="admonition abstract">
<p class="admonition-title">9.1 Display the catalogs</p>
<div class="highlight"><pre><span></span><code>show catalogs;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">9.2 Show schemas in tpch</p>
<div class="highlight"><pre><span></span><code>show schemas in tpch;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">9.3 Set the catalog to tpch.tiny</p>
<div class="highlight"><pre><span></span><code>USE tpch.tiny;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">9.4 View tables in the current schema</p>
<div class="highlight"><pre><span></span><code>show tables; 
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">9.5 Set the catalog to tpch.tiny and show the tables</p>
<div class="highlight"><pre><span></span><code>USE tpch.tiny;
show tables;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">9.6 Inspect schema of the customer table</p>
<div class="highlight"><pre><span></span><code>use tpch.tiny;
describe customer;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">9.7 Show the customer table columns using an alternate format</p>
<div class="highlight"><pre><span></span><code>show columns from tpch.tiny.customer;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">9.8 Inspect available Date functions</p>
<div class="highlight"><pre><span></span><code>show functions like &#39;date%&#39;;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">9.9 View the contents of the sf1 schema</p>
<div class="highlight"><pre><span></span><code>show tables in tpch.sf1;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">9.10 Query data from customer table</p>
<div class="highlight"><pre><span></span><code>select * from tpch.sf1.customer limit 5;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">9.11 Gather statistics on the customer table</p>
<div class="highlight"><pre><span></span><code>show stats for tpch.sf1.customer;
</code></pre></div>
</div>
<h2 id="chapter-10-analytic-workloads">Chapter 10 - Analytic Workloads</h2>
<div class="admonition abstract">
<p class="admonition-title">10.1 Create the workshop schema in the iceberg_data catalog</p>
<div class="highlight"><pre><span></span><code>CREATE SCHEMA IF NOT EXISTS iceberg_data.workshop 
with (location=&#39;s3a://iceberg-bucket/&#39;);
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.2 Create the workshop customer table</p>
<div class="highlight"><pre><span></span><code>create table iceberg_data.workshop.customer as 
  select * from tpch.tiny.customer;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.3 Run a simple scan query which selects customer names and market segment</p>
<div class="highlight"><pre><span></span><code>use iceberg_data.workshop; 
select 
  name, mktsegment 
from 
  customer 
limit 3;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.4 Run an explain against the previous statement</p>
<div class="highlight"><pre><span></span><code>use iceberg_data.workshop;
explain select name, mktsegment from customer;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.5 Explain the query and focus on IO operations</p>
<div class="highlight"><pre><span></span><code>use iceberg_data.workshop;
explain (type io) select name, mktsegment from customer;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.6 Explain physical execution plan for the query</p>
<div class="highlight"><pre><span></span><code>use iceberg_data.workshop;
explain (type distributed) select name, mktsegment from customer;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.7 Enter the following query into the SQL window and press the Explain button</p>
<div class="highlight"><pre><span></span><code>select 
  name, mktsegment 
from 
  iceberg_data.workshop.customer 
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.8 Create a partitioned table</p>
<div class="highlight"><pre><span></span><code>create table iceberg_data.workshop.part_customer 
  with (partitioning = array[&#39;mktsegment&#39;]) 
as select * from tpch.tiny.customer;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.9 Run a query against the partitioned table</p>
<div class="highlight"><pre><span></span><code>select
  * 
from 
  iceberg_data.&quot;workshop&quot;.part_customer 
where 
  mktsegment=&#39;MACHINERY&#39;;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.10 Create the Orders Table</p>
<div class="highlight"><pre><span></span><code>create table iceberg_data.workshop.orders as 
  select * from tpch.tiny.orders;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.11 SQL with a Windowing function</p>
<div class="highlight"><pre><span></span><code>SELECT 
  orderkey, clerk, totalprice, 
  rank() OVER (PARTITION BY clerk ORDER BY totalprice DESC) AS rnk 
FROM 
  iceberg_data.workshop.orders 
ORDER BY 
  clerk, rnk;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.12 Save a query as a prepared statement</p>
<div class="highlight"><pre><span></span><code>prepare 
  customer_by_segment
from 
  select * from iceberg_data.workshop.customer where mktsegment=?;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">10.13 Execute prepared statement using parameters</p>
<div class="highlight"><pre><span></span><code>prepare 
  customer_by_segment
from 
  select * from iceberg_data.workshop.customer where mktsegment=?;    
execute customer_by_segment using &#39;FURNITURE&#39;;
</code></pre></div>
</div>
<h2 id="11-advanced-functions">11 - Advanced Functions</h2>
<div class="admonition abstract">
<p class="admonition-title">11.1 Concatenate two strings</p>
<div class="highlight"><pre><span></span><code>select 
   concat(cast(custkey as varchar),&#39;-&#39;,name) 
from 
   iceberg_data.workshop.customer
limit 2;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">11.2 Select orders from the last 2 days</p>
<div class="highlight"><pre><span></span><code>select
   orderdate 
from 
   iceberg_data.workshop.orders 
where 
   orderdate &gt;  date &#39;1998-08-02&#39; - interval &#39;2&#39; day;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">11.3 Compute the number of orders by year</p>
<div class="highlight"><pre><span></span><code>select 
   distinct year(orderdate), count(orderkey) 
from 
   iceberg_data.workshop.orders 
group by 
   year(orderdate);
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">11.4 SQL Representation of Co-ordinates</p>
<div class="highlight"><pre><span></span><code>select 
   ST_Point(-121.748360,37.195840)  as SVL, 
   ST_Point(-122.378952, 37.621311) as SFO;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">11.5 SQL Representation of a Line</p>
<div class="highlight"><pre><span></span><code>select 
   ST_LineFromText(&#39;LINESTRING (-121.74294303079807 37.19665657093434, -121.73659072815602 37.20102399761407)&#39;);
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">11.6 SQL Representation of a Polygon</p>
<div class="highlight"><pre><span></span><code>select ST_Polygon(&#39;POLYGON (
   (-121.74418635253568 37.196001834113844, 
   -121.74499684288966 37.19668005184322,
   -121.74584008032835 37.19707784979194,  
   -121.74629035274705 37.197645197338105, 
   -121.74672425162339 37.198186455965086, 
   -121.74705172247337 37.19828427337538, 
   -121.74760023614738 37.19827775221884,  
   -121.74848440744239 37.19836252721197, 
   -121.74932764488139 37.19789300297414,  
   -121.75039192514376 37.19746260319114, 
   -121.75130884352407 37.19721479614175, 
   -121.75195559845278 37.1963670290329, 
   -121.75198015876644 37.19555185937345,  
   -121.7508585711051 37.19458016564036, 
   -121.74940132582242 37.19447582194559,  
   -121.74841891327239 37.1942866986312,
   -121.7474446874937 37.193556286900346, 
   -121.74418635253568 37.196001834113844))&#39;);
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">11.7 Distance between SFO airport and IBM SVL</p>
<div class="highlight"><pre><span></span><code>select 
   ST_Distance(to_spherical_geography(ST_Point(-122.378952, 37.621311)), 
   to_spherical_geography(ST_Point(-121.748360,37.195840)))*0.000621371 as distance_in_miles;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">11.8 What queries are currently running?</p>
<div class="highlight"><pre><span></span><code>select * from &quot;system&quot;.runtime.queries limit 5;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">11.9 What tasks make up a query and where is the task running?</p>
<div class="highlight"><pre><span></span><code>select * from &quot;system&quot;.runtime.tasks limit 5;
</code></pre></div>
</div>
<h2 id="12-time-travel">12 - Time Travel</h2>
<div class="admonition abstract">
<p class="admonition-title">12.1 Check current snapshots – STARTING STATE</p>
<div class="highlight"><pre><span></span><code>SELECT 
   * 
FROM 
   iceberg_data.workshop.&quot;customer$snapshots&quot; 
ORDER BY 
   committed_at;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">12.2 Capture the first snapshot ID</p>
<div class="highlight"><pre><span></span><code>SELECT 
   snapshot_id 
FROM 
   iceberg_data.workshop.&quot;customer$snapshots&quot; 
ORDER BY 
   committed_at;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">12.3 Insert a new customer record into the table</p>
<p><div class="highlight"><pre><span></span><code>insert into iceberg_data.workshop.customer 
   values(1501,&#39;Deepak&#39;,&#39;IBM SVL&#39;,16,&#39;123-212-3455&#39;,
          123,&#39;AUTOMOBILE&#39;,&#39;Testing snapshots&#39;);
</code></pre></div>
</p>
</div>
<div class="admonition abstract">
<p class="admonition-title">12.4 View available snapshots</p>
<div class="highlight"><pre><span></span><code>SELECT 
   * 
FROM 
   iceberg_data.workshop.&quot;customer$snapshots&quot; 
ORDER BY 
   committed_at;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">12.5 Select customer Deepak</p>
<div class="highlight"><pre><span></span><code>select * from iceberg_data.workshop.customer where name=&#39;Deepak&#39;;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">12.6 View the available snapshots</p>
<div class="highlight"><pre><span></span><code>SELECT 
   snapshot_id 
FROM 
   iceberg_data.workshop.&quot;customer$snapshots&quot; 
ORDER BY 
   committed_at;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">12.7 Rollback to previous snapshot - Replace the ID parameter with the snapshot ID previously found. Remember the closing parenthesis!</p>
<div class="highlight"><pre><span></span><code>CALL iceberg_data.system.rollback_to_snapshot(&#39;workshop&#39;,&#39;customer&#39;,ID)
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">12.8 Select customer Deepak</p>
<div class="highlight"><pre><span></span><code>select * from iceberg_data.workshop.customer where name=&#39;Deepak&#39;;
</code></pre></div>
</div>
<h2 id="13-federation">13 Federation</h2>
<div class="admonition abstract">
<p class="admonition-title">13.1 Select the names of employees in the GOSALES database with employee ids between 4000 and 5000</p>
<div class="highlight"><pre><span></span><code>select 
  go.&quot;EMPLOYEE_KEY&quot;, go.&quot;FIRST_NAME&quot;, go.&quot;LAST_NAME&quot; 
from 
  gosales.&quot;GOSALESDW&quot;.&quot;EMP_EMPLOYEE_DIM&quot; go
where 
  go.&quot;EMPLOYEE_KEY&quot; between 4000 and 5000
order by 
  go.&quot;EMPLOYEE_KEY&quot;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">13.2 Select TPCH customers who are employees in GOSALES</p>
<div class="highlight"><pre><span></span><code>select 
  t1.custkey, go.&quot;FIRST_NAME&quot;, go.&quot;LAST_NAME&quot; 
from 
  tpch.sf1.customer t1, gosales.&quot;GOSALESDW&quot;.&quot;EMP_EMPLOYEE_DIM&quot; go
where 
   t1.custkey between 4000 and 5000 AND
   go.&quot;EMPLOYEE_KEY&quot; = t1.custkey
order by 
   t1.custkey
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">13.3 Create a table in iceberg_data using the Db2 employee table</p>
<div class="highlight"><pre><span></span><code>create table iceberg_data.workshop.db2employee AS 
  select 
    go.&quot;EMPLOYEE_KEY&quot;, go.&quot;FIRST_NAME&quot;, go.&quot;LAST_NAME&quot; 
  from 
    gosales.&quot;GOSALESDW&quot;.&quot;EMP_EMPLOYEE_DIM&quot; go
  where 
    go.&quot;EMPLOYEE_KEY&quot; between 4000 and 5000
  order by 
    go.&quot;EMPLOYEE_KEY&quot;
</code></pre></div>
</div>
<div class="admonition abstract">
<p class="admonition-title">13.4 Query the contents of the new db2employee table</p>
<div class="highlight"><pre><span></span><code>select * from iceberg_data.workshop.db2employee
</code></pre></div>
</div>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../wxd-documentation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Documentation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Documentation
            </div>
          </div>
        </a>
      
      
        
        <a href="../wxd-glossary/" class="md-footer__link md-footer__link--next" aria-label="Next: Glossary" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Glossary
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 IBM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>