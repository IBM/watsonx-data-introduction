
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Watsonx.data Certificates - Introducing watsonx.data</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"IBM Plex Sans";--md-code-font:"IBM Plex Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#watsonxdata-certificates" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Introducing watsonx.data" class="md-header__button md-logo" aria-label="Introducing watsonx.data" data-md-component="logo">
      
  <img src="../wxd-images/IBM_logo®_rev_RGB.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introducing watsonx.data
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Watsonx.data Certificates
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Introducing watsonx.data" class="md-nav__button md-logo" aria-label="Introducing watsonx.data" data-md-component="logo">
      
  <img src="../wxd-images/IBM_logo®_rev_RGB.png" alt="logo">

    </a>
    Introducing watsonx.data
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-reference-ibmid/" class="md-nav__link">
        Requesting an IBMid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-reference-workshop/" class="md-nav__link">
        Accessing a workshop
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-lab-instructions/" class="md-nav__link">
        Lab Instructions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          watsonx.data UI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="watsonx.data UI" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          watsonx.data UI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-watsonui/" class="md-nav__link">
        Watsonx UI Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-infrastructure/" class="md-nav__link">
        Infrastructure Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-datamanager/" class="md-nav__link">
        Data Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-queryworkspace/" class="md-nav__link">
        Query Workspace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-queryhistory/" class="md-nav__link">
        Query History
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wxd-accesscontrol/" class="md-nav__link">
        Access Control
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-connect-to-the-server" class="md-nav__link">
    Step 1: Connect to the Server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-update-the-certificate" class="md-nav__link">
    Step 2: Update the Certificate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-stop-and-restart-the-system" class="md-nav__link">
    Step 3: Stop and Restart the System
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-generate-custom-certificate" class="md-nav__link">
    Step 4: Generate Custom Certificate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-generate-java-keystore-file" class="md-nav__link">
    Step 5: Generate Java Keystore File
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-create-certificate-and-keystore-copies" class="md-nav__link">
    Step 6: Create Certificate and Keystore Copies
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="watsonxdata-certificates">Watsonx.data Certificates</h1>
<div class="admonition error">
<p class="admonition-title">Watsonx.data Certificate Failure</p>
</div>
<p>Due to a change in TechZone URLs, the self-signed certificates in the watsonx.data Developer image may be invalid. If you are attempting to connect to the watsonx.data system from outside the virtual machine, you will need to run the following commands to fix the self-signed certificate. </p>
<h3 id="step-1-connect-to-the-server">Step 1: Connect to the Server</h3>
<p>Use the SSH port to connect into the server and make sure that you become the root user.</p>
<div class="highlight"><pre><span></span><code>sudo su -
</code></pre></div>
<h3 id="step-2-update-the-certificate">Step 2: Update the Certificate</h3>
<p>We need to update the certificate by using a utility in the developer toolbox.  Start the toolbox code by switching to the bin directory and issuing the following command.
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> /root/ibm-lh-dev/bin
./dev-sandbox
</code></pre></div></p>
<p>Once inside the development container, you will need to update the program that generates the certificates. <strong>Note</strong>: The certificate should cover all TechZone locations. If for some reason your TechZone server does not match the pattern <code>*.services.cloud.techzone.ibm.com</code>, update it in the command below.</p>
<div class="highlight"><pre><span></span><code>sed -i <span class="s1">&#39;/DNS.14.*/a DNS.15 = watsonxdata&#39;</span> /scripts/gen_certs.sh
sed -i <span class="s1">&#39;/DNS.15.*/a DNS.16 = watsonxdata.gym.lan&#39;</span> /scripts/gen_certs.sh
sed -i <span class="s1">&#39;/DNS.16.*/a DNS.17 = *.services.cloud.techzone.ibm.com&#39;</span> /scripts/gen_certs.sh
./scripts/gen_certs.sh
</code></pre></div>
<p>Once the script completes, exit the toolkit.</p>
<div class="highlight"><pre><span></span><code><span class="nb">exit</span>
</code></pre></div>
<h3 id="step-3-stop-and-restart-the-system">Step 3: Stop and Restart the System</h3>
<p>The certificates need to be replaced in all the running containers. You must stop and restart them. You must include the diagnostic flag or else the system will not work properly. The startup will take some time to complete. The Postgres pod will display some warning messages which can be safely ignored.</p>
<div class="highlight"><pre><span></span><code>./stop.sh
<span class="nb">export</span> <span class="nv">LH_RUN_MODE</span><span class="o">=</span>diag
./start.sh 
</code></pre></div>
<h3 id="step-4-generate-custom-certificate">Step 4: Generate Custom Certificate</h3>
<p>The first step is to copy the new certificates to the central <code>/certs</code> directory use by this image.</p>
<div class="highlight"><pre><span></span><code>docker cp ibm-lh-presto:/mnt/infra/tls/lh-ssl-ts.jks /certs/lh-ssl-ts.jks
docker cp ibm-lh-presto:/mnt/infra/tls/cert.crt /certs/lh-ssl-ts.crt
</code></pre></div>
<p>Next we need to generate the certificate file that is used by a number of the examples in the lab instructions.</p>
<div class="highlight"><pre><span></span><code>rm -f presto.crt
<span class="nb">echo</span> QUIT <span class="p">|</span> openssl s_client -showcerts -connect <span class="m">127</span>.0.0.1:8443 <span class="p">|</span> awk <span class="s1">&#39;/-----BEGIN CERTIFICATE-----/ {p=1}; p; /-----END CERTIFICATE-----/ {p=0}&#39;</span> &gt; presto.crt
</code></pre></div>
<p>You can print the certificate if you need it for connections from CP4D.</p>
<div class="highlight"><pre><span></span><code>cat presto.crt
</code></pre></div>
<h3 id="step-5-generate-java-keystore-file">Step 5: Generate Java Keystore File</h3>
<p>The next step will create the Java Keystore file. When prompted, use a password of <code>watsonx.data</code> and say <code>yes</code> to accepting the certificate. Make sure that you see your host in the list. For instance, <code>useast.services.cloud.techzone.ibm.com</code> should be displayed when you see the results.</p>
<div class="highlight"><pre><span></span><code>rm -f presto-key.jks
keytool -import -alias presto-crt -file ./presto.crt -keystore ./presto-key.jks
</code></pre></div>
<p>The following is an example of the output from the <code>keytool</code> command.</p>
<pre style="font-size: small; color: darkgreen; overflow: auto">
Owner: CN=Dummy-Self-signed-Cert, EMAILADDRESS=dummy@example.dum, OU=For-CPD, O=Data and AI, L=Home-Town, ST=XX, C=YY
Issuer: CN=Dummy-Self-signed-Cert, EMAILADDRESS=dummy@example.dum, OU=For-CPD, O=Data and AI, L=Home-Town, ST=XX, C=YY
Serial number: 73f26644ad83ac8cdf9afbda6006d4e52f244fac
Valid from: Tue Mar 05 17:42:56 EST 2024 until: Wed May 23 18:42:56 EDT 2035
Certificate fingerprints:
         SHA1: 3A:6C:52:80:3D:14:CF:D0:E7:AC:14:13:6F:46:FB:B1:8C:BA:E4:37
         SHA256: 28:E7:AD:4E:BA:5F:00:4C:B7:2E:61:3E:3B:96:E5:DF:01:D5:80:CE:1A:B3:EF:B7:86:11:26:4A:B6:7C:90:8A
Signature algorithm name: SHA512withRSA
Subject Public Key Algorithm: 2048-bit RSA key
Version: 3

Extensions: 

#1: ObjectId: 2.5.29.37 Criticality=false
ExtendedKeyUsages [
  serverAuth
]

#2: ObjectId: 2.5.29.17 Criticality=false
SubjectAlternativeName [
  DNSName: ibm-lh-presto-svc
  DNSName: *.svc.cluster.local
  DNSName: api-svc
  DNSName: *.api
  DNSName: localhost
  DNSName: ibm-lh-hive-metastore
  DNSName: ibm-lh-hive-metastore-svc
  DNSName: lhconsole-api-svc
  DNSName: lhconsole-nodeclient-svc
  DNSName: ibm-lh-ranger-svc
  DNSName: ibm-lh-javaapi-svc
  DNSName: ibm-lh-prestissimo-svc
  DNSName: ibm-lh-qhmm
  DNSName: ibm-lh-qhmm-svc
  DNSName: watsonxdata
  DNSName: watsonxdata.gym.lan
  DNSName: *.services.cloud.techzone.ibm.com
]

Trust this certificate? [no]:  yes
Certificate was added to keystore
</pre>

<h3 id="step-6-create-certificate-and-keystore-copies">Step 6: Create Certificate and Keystore Copies</h3>
<p>The final step is to copy the certs and keystore values in a central location so they can be used in various scripts and notebooks.</p>
<div class="highlight"><pre><span></span><code><span class="se">\c</span>p -f presto-key.jks /certs
<span class="se">\c</span>p -f presto.crt /certs

chmod +r /certs/*.*

<span class="se">\c</span>p -rf /certs /notebooks/
</code></pre></div>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 IBM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>